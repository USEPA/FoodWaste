{% extends "main/base.html" %}

{% block content %}

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <form action="/trackingtool/create/" method="post">
                <div class="form-group">
                    <label for="" class="col-sm-3 control-label">{{form.work.label}}</label>
                    <div class="col-sm-9">{{form.work}}</div>
                </div>
                <div class="form-group">
                    <label for="" class="col-sm-3 control-label">{{form.email.label}}</label>
                    <div class="col-sm-9">{{form.email}}</div>
                </div>
                <div class="form-group">
                    <label for="" class="col-sm-3 control-label">{{form.phone.label}}</label>
                    <div class="col-sm-9">{{form.phone}}</div>
                </div>
                <div class="form-group col-sm-12">
                    <label for="" class="col-sm-3 control-label">{{form.search.label}}</label>
                    <div class="col-sm-9">
                        <div class="col-sm-11">{{form.search}}</div>
                        <a id="searchLink" onclick="goSearch()" class="col-sm-1 btn btn-md btn-secondary disabled">Go</a>
                    </div>
                </div>
                <div class="form-group col-sm-12 hidden-div" style="display: none;">
                    <label for="" class="col-sm-3 control-label">{{form.article_title.label}}</label>
                    <div class="col-sm-9">{{form.article_title}}</div>
                </div>
                <div class="form-group col-sm-12 hidden-div" style="display: none;">
                    <label for="" class="col-sm-3 control-label">{{form.comments.label}}</label>
                    <div class="col-sm-9">{{form.comments}}</div>
                </div>
                <div class="col-md-12">
                    <button type="submit" value="Update" class="m-2 col-md-2 btn btn-md btn-success" disabled>Save</button>
                    <button type="reset" class="m-2 col-md-2 col-md-offset-1 btn btn-md btn-warning">Reset</button>
                    <button type="reset" onclick="window.location.href='/trackingtool/'"
                            class="m-2 col-md-2 col-md-offset-1 btn btn-md btn-danger">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
    var searchUrl = '';
    (function () {
        $('#searchLink').on('change textInput input', searchFieldUpdate());
        $('#searchLink').on('click', goSearch());
    });

    function searchFieldUpdate() {
        var searchTerm = $("#id_search").val();
        if (searchTerm.length > 5) {
            $("#searchLink").removeClass('disabled');
            $("#searchLink").addClass('btn-success');
            $("#searchLink").removeClass('btn-secondary');
            var url = 'https://www.google.com/search?q=' + searchTerm;
            // $("#searchLink").prop('href', url);
            searchUrl = url;
        } else {
            if (!$("#searchLink").hasClass('disabled')) {
                $("#searchLink").addClass('disabled');
                $("#searchLink").addClass('btn-secondary');
                $("#searchLink").removeClass('btn-success');
                hidePostSearchFields();
            }
            // $("#searchLink").prop('href', '');
            searchUrl = '';
        }
    }

    function goSearch() {
        if (searchUrl.length !== 0) {
            showPostSearchFields();
            window.open(searchUrl);
        }
    }

    function hidePostSearchFields() {
        $(".hidden-div").each(function () {
            $(this).hide();
        });
    }

    function showPostSearchFields() {
        $(".hidden-div").each(function () {
            $(this).show();
        });
    }
</script>
{% endblock %}